---
description: Ce que fait le gestionnaire de pilotes
title: Ce que fait le gestionnaire de pilotes | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 399dec39e18c9e31ce4a93172d0597c333fb40cb
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/17/2020
ms.locfileid: "88386165"
---
# <a name="what-the-driver-manager-does"></a>Ce que fait le gestionnaire de pilotes
Le tableau suivant résume la façon dont le gestionnaire de pilotes ODBC *3. x* mappe les appels aux pilotes ODBC *2. x* et ODBC *3. x* .  
  
|Function ou<br /><br /> attribut d'instruction|Commentaires|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Pointe vers le signet à utiliser avec **SQLFetchScroll**. Voici les détails de l’implémentation :<br /><br /> -Quand une application définit cela dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* le met en cache. Elle déréférence le pointeur et transmet la valeur au pilote ODBC *2. x* dans l’argument *FetchOffset* de **SQLExtendedFetch** lorsque **SQLFetchScroll** est appelé par la suite par l’application.<br />-Quand une application définit cette valeur dans un pilote ODBC *3. x* , le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote.|  
|SQL_ATTR_ROW_STATUS_PTR|Pointe vers le tableau d’état de ligne rempli par **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**et **SQLSetPos**. Voici les détails de l’implémentation :<br /><br /> -Quand une application définit cela dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* met en cache sa valeur. Elle transmet cette valeur au pilote ODBC *2. x* dans l’argument *RowStatusArray* de **SQLExtendedFetch** lorsque **SQLFetchScroll** ou **SQLFetch** est appelé.<br />-Quand une application définit cette valeur dans un pilote ODBC *3. x* , le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote.<br />-Dans l’État S6, si une application définit SQL_ATTR_ROW_STATUS_PTR puis appelle **SQLBulkOperations** (avec une *opération* de SQL_ADD) ou **SQLSetPos** sans appeler d’abord **SQLFetch** ou **SQLFetchScroll**, SQLSTATE HY011 (l’attribut ne peut pas être défini maintenant) est retourné.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Pointe vers la mémoire tampon dans laquelle **SQLFetch** et **SQLFetchScroll** retournent le nombre de lignes extraites. Voici les détails de l’implémentation :<br /><br /> -Quand une application définit cela dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* met en cache sa valeur. Elle transmet cette valeur au pilote ODBC *2. x* dans l’argument *RowCountPtr* de **SQLExtendedFetch** lorsque **SQLFetch** ou **SQLFetchScroll** est appelé par l’application.<br />-Quand une application définit cette valeur dans un pilote ODBC *3. x* , le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Définit la taille de l’ensemble de lignes. Voici les détails de l’implémentation :<br /><br /> -Quand une application définit cette valeur dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* le mappe à l’attribut d’instruction SQL_ROWSET_SIZE.<br />-Quand une application définit cette valeur dans un pilote ODBC *3. x* , le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote.<br />-Lorsqu’une application qui utilise un pilote ODBC *3. x* appelle **SQLSetScrollOptions**, SQL_ROWSET_SIZE est défini sur la valeur de l’argument *RowsetSize* si le pilote sous-jacent ne prend pas en charge **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Définit la taille de l’ensemble de lignes utilisée par **SQLExtendedFetch** quand **SQLExtendedFetch** est appelé par une application ODBC *2. x* . Voici les détails de l’implémentation :<br /><br /> -Quand une application définit cela, le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote, quelle que soit la version du pilote.<br />-Lorsqu’une application qui utilise un pilote ODBC *2. x* appelle **SQLSetScrollOptions**, SQL_ROWSET_SIZE est défini sur la valeur dans l’argument **RowsetSize** .|  
|**SQLBulkOperations**|Effectue une opération d’insertion, ou mise à jour, suppression ou extraction par les opérations de signet. Voici les détails de l’implémentation :<br /><br /> -Quand une application appelle **SQLBulkOperations** avec une *opération* de SQL_ADD dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* le mappe à **SQLSetPos** avec une *opération* de SQL_ADD.<br />-Lorsque vous utilisez un pilote ODBC *2. x* qui ne prend pas en charge **SQLSetPos** avec une *opération* de SQL_ADD, le gestionnaire de pilotes ODBC *3. x* ne mappe pas **SQLSetPos** avec *une opération de* SQL_ADD à **SQLBulkOperations** avec une *opération* de SQL_ADD. Cela est dû au fait que **SQLBulkOperations** ne peut pas être appelé dans l’État S7, qui, dans ODBC *2. x* , était le seul État dans lequel **SQLSetPos** pouvait être appelé.<br />-Si l’application appelle **SQLBulkOperations** avec une *opération* de SQL_ADD dans un pilote ODBC *2. x* avant d’appeler **SQLFetchScroll**, le gestionnaire de pilotes ODBC *3. x* retourne une erreur.|  
|**SQLExtendedFetch**|Retourne l’ensemble de lignes spécifié. À l’exception de la restriction qui vient d’être notée, le gestionnaire de pilotes ODBC *3. x* passe des appels à **SQLExtendedFetch** au pilote, quelle que soit la version du pilote.|  
|**SQLFetch**|Retourne l’ensemble de lignes suivant. Voici les détails de l’implémentation :<br /><br /> -Quand une application appelle **SQLFetch** dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* le mappe à **SQLExtendedFetch**. L’argument *FetchOrientation* de **SQLExtendedFetch** a la valeur SQL_FETCH_NEXT. Le gestionnaire de pilotes utilise la valeur mise en cache de l’attribut d’instruction SQL_ATTR_ROW_STATUS_PTR pour l’argument *RowStatusArray* et la valeur mise en cache de l’attribut d’instruction SQL_ATTR_ROWS_FETCHED_PTR pour l’argument *RowCountPtr* .<br />-Une application *ODBC 3. x* peut combiner des appels **à SQLFetch** et **SQLFetchScroll** dans un pilote ODBC *2. x* , car le gestionnaire de pilotes ODBC *3. x* mappe **SQLFetch** à **SQLExtendedFetch** quand une application l’appelle dans un pilote ODBC *2. x* .<br />-Si un pilote ODBC *2. x* ne prend pas en charge **SQLExtendedFetch**, le gestionnaire de pilotes ODBC *3. x* ne mappe pas **SQLFetch** ou **SQLFetchScroll** à **SQLExtendedFetch** quand une application l’appelle dans ce pilote. Si l’application tente de définir SQL_ATTR_ROW_ARRAY_SIZE sur une valeur supérieure à 1, SQLSTATE HYC00 (fonctionnalité facultative non implémentée) est retournée.<br />-À l’exception des restrictions qui viennent d’être notées, le gestionnaire de pilotes ODBC *3. x* transmet les appels à **SQLFetch** au pilote, quelle que soit la version du pilote.|  
|**SQLFetchScroll**|Retourne l’ensemble de lignes spécifié. Voici les détails de l’implémentation :<br /><br /> -Quand une application appelle **SQLFetchScroll** dans un pilote ODBC *2. x* , le gestionnaire de pilotes ODBC *3. x* le mappe à **SQLExtendedFetch**. Elle utilise la valeur mise en cache de l’attribut d’instruction SQL_ATTR_ROW_STATUS_PTR pour l’argument *RowStatusArray* et la valeur mise en cache de l’attribut d’instruction SQL_ATTR_ROWS_FETCHED_PTR pour l’argument *RowCountPtr* . Si l’argument *FetchOrientation* dans **SQLFetchScroll** est SQL_FETCH_BOOKMARK, il utilise la valeur mise en cache de l’attribut d’instruction SQL_ATTR_FETCH_BOOKMARK_PTR pour l’argument *FetchOffset* et retourne une erreur si l’argument *FetchOffset* de **SQLFetchScroll** n’est pas égal à 0.<br />-Quand une application l’appelle dans un pilote ODBC *3. x* , le gestionnaire de pilotes ODBC *3. x* passe l’appel au pilote.|  
|**SQLSetPos**|Effectue plusieurs opérations positionnées. Le gestionnaire de pilotes ODBC *3. x* transmet les appels à **SQLSetPos** au pilote, quelle que soit la version du pilote.|  
|**SQLSetScrollOptions**|Quand le gestionnaire de pilotes mappe **SQLSetScrollOptions** pour une application qui utilise un pilote ODBC *3. x* qui ne prend pas en charge **SQLSetScrollOptions**, le gestionnaire de pilotes définit l’option d’instruction SQL_ROWSET_SIZE, et non l’attribut d’instruction SQL_ATTR_ROW_ARRAY_SIZE, sur l’argument *RowsetSize* dans **SQLSetScrollOption**. Par conséquent, **SQLSetScrollOptions** ne peut pas être utilisé par une application lors de l’extraction de plusieurs lignes par un appel à **SQLFetch** ou **SQLFetchScroll**. Il peut être utilisé uniquement lors de l’extraction de plusieurs lignes par un appel à **SQLExtendedFetch**.|
